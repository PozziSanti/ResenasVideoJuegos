{% extends 'base.html' %}
{% block content %}
  <h1>Posts</h1>

  {% if user.is_authenticated and request.rol != 'guest' %}
    <a href="{% url 'crear_post' %}">Crear nuevo post</a>
  {% endif %}

  {% for post in posts %}
    <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 15px;">
      <h2>{{ post.titulo }}</h2>
      <p>{{ post.contenido }}</p>
      <p><strong>Autor:</strong> {{ post.autor.username }}</p>

      {% if user == post.autor or request.rol == 'admin' %}
        <a href="{% url 'editar_post' post.id %}">Editar</a> |
        <a href="{% url 'eliminar_post' post.id %}">Eliminar</a>
      {% endif %}

      {% if user.is_authenticated and request.rol != 'guest' %}
        <form action="{% url 'comentar_post' post.id %}" method="post">
          {% csrf_token %}
          <input type="text" name="contenido" placeholder="EscribÃ­ un comentario" required>
          <button type="submit">Comentar</button>
        </form>
      {% endif %}

      <h4>Comentarios:</h4>
      {% for comentario in post.comentarios.all %}
        <p><strong>{{ comentario.autor.username }}:</strong> {{ comentario.contenido }}</p>
      {% empty %}
        <p>No hay comentarios.</p>
      {% endfor %}
    </div>
  {% endfor %}
{% endblock %}